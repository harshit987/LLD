<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2949.667023203047 1290.4765625" width="8849.001069609141" height="3871.4296875">
  <!-- svg-source:excalidraw -->
  
  <defs>
    <style class="style-fonts">
      @font-face {
        font-family: "Virgil";
        src: url("https://excalidraw.com/Virgil.woff2");
      }
      @font-face {
        font-family: "Cascadia";
        src: url("https://excalidraw.com/Cascadia.woff2");
      }
      @font-face {
        font-family: "Assistant";
        src: url("https://excalidraw.com/Assistant-Regular.woff2");
      }
    </style>
    
  </defs>
  <rect x="0" y="0" width="2949.667023203047" height="1290.4765625" fill="#ffffff"></rect><g stroke-linecap="round" transform="translate(908.4857487889843 86.3125) rotate(0 128.75390625 86.630859375)"><path d="M32 0 C87.98 -2.63, 139.8 -0.36, 225.51 0 M32 0 C82.62 -0.66, 133.89 -0.8, 225.51 0 M225.51 0 C248.03 1.16, 256.31 10.51, 257.51 32 M225.51 0 C247.18 0.9, 256.38 9.2, 257.51 32 M257.51 32 C256.56 72.04, 257.61 114.28, 257.51 141.26 M257.51 32 C257.93 62.99, 257.67 93.02, 257.51 141.26 M257.51 141.26 C256.03 162.36, 246.77 174.1, 225.51 173.26 M257.51 141.26 C258.28 161.26, 248.03 175.29, 225.51 173.26 M225.51 173.26 C157.92 174.49, 87.57 175.98, 32 173.26 M225.51 173.26 C155.19 174.77, 84.55 174.09, 32 173.26 M32 173.26 C10.41 171.3, 0.66 164.02, 0 141.26 M32 173.26 C11.62 173.24, 0.41 162.71, 0 141.26 M0 141.26 C0 99.24, 2.41 54.5, 0 32 M0 141.26 C0.47 103.41, 0.46 67.47, 0 32 M0 32 C0.05 8.75, 12.16 1.05, 32 0 M0 32 C0.27 12.28, 11.86 1.21, 32 0" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(910.0716862889843 133.125) rotate(0 130.2467964150012 0.28347772319344244)"><path d="M-0.4 0.8 C42.98 0.54, 217.14 -0.37, 260.89 -0.45 M1.59 0.17 C44.72 0.61, 216.34 1.25, 259.68 0.92" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g></g><mask></mask><g transform="translate(968.2279362889843 104.20703125) rotate(0 41.13996124267578 12.5)"><text x="0" y="17.52" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Message</text></g><g transform="translate(932.2279362889843 150.20703125) rotate(0 66.81993865966797 12.5)"><text x="0" y="17.52" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">- text: String</text></g><g stroke-linecap="round" transform="translate(387.4232487889843 151.94140625) rotate(0 135.3671875 103.056640625)"><path d="M32 0 C87.17 -0.19, 140.5 0.49, 238.73 0 M32 0 C106.16 -1.51, 180.78 -0.19, 238.73 0 M238.73 0 C258.33 -1, 271.26 11.52, 270.73 32 M238.73 0 C257.98 2.09, 270.92 11.84, 270.73 32 M270.73 32 C270.4 74.53, 271.67 113.11, 270.73 174.11 M270.73 32 C272.43 75.63, 271.16 121.12, 270.73 174.11 M270.73 174.11 C269.27 194.56, 261.2 207.64, 238.73 206.11 M270.73 174.11 C272.2 195.84, 261.4 205.64, 238.73 206.11 M238.73 206.11 C157.57 207.27, 74.21 206.38, 32 206.11 M238.73 206.11 C168.18 205.2, 97.38 206.1, 32 206.11 M32 206.11 C10.44 207.92, -1.52 196.51, 0 174.11 M32 206.11 C10.05 207.82, -1.04 196.73, 0 174.11 M0 174.11 C1.78 137.16, -0.65 99.58, 0 32 M0 174.11 C-1.34 143.75, -0.65 114.87, 0 32 M0 32 C-1.31 9.12, 12.64 -1.16, 32 0 M0 32 C0.58 11.8, 12.59 -2.21, 32 0" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g transform="translate(402.1419987889843 168.69140625) rotate(0 25.719970703125 25)"><text x="0" y="17.52" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Topic</text><text x="0" y="42.519999999999996" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic"></text></g><g stroke-linecap="round"><g transform="translate(389.5365300389843 212.796875) rotate(0 133.65858157079202 -0.06456279978155521)"><path d="M-1.05 0.6 C43.39 0.29, 221.42 -0.51, 266.15 -0.73 M0.6 -0.14 C45.45 0.22, 224.01 0.42, 268.37 0.5" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g></g><mask></mask><g transform="translate(389.1419987889843 229.69140625) rotate(0 132.2898712158203 62.5)"><text x="0" y="17.52" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">- id: int</text><text x="0" y="42.519999999999996" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">- capacity: int</text><text x="0" y="67.52" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">- list&lt;Message&gt;: messages;</text><text x="0" y="92.52" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic"></text><text x="0" y="117.52" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic"></text></g><g stroke-linecap="round" transform="translate(660.3724675389843 225.09765625) rotate(0 13.65625 11.0078125)"><path d="M17.5 3 C19.16 5.02, 22.93 7.74, 23.81 9 M17.5 3 C19.49 4.55, 21.47 6.72, 23.81 9 M23.81 9 C25.93 12.86, 26.11 10.23, 23.81 15 M23.81 9 C25.15 11.74, 27.67 11.94, 23.81 15 M23.81 15 C21.54 16.19, 20.52 17.08, 17.5 19.02 M23.81 15 C21.75 16, 20.28 16.98, 17.5 19.02 M17.5 19.02 C14.52 20.25, 12.04 22.94, 10.5 19.02 M17.5 19.02 C14.14 23.39, 12.88 21, 10.5 19.02 M10.5 19.02 C9.11 18.62, 7.16 16.67, 3.5 15 M10.5 19.02 C8.63 17.58, 6.75 16.5, 3.5 15 M3.5 15 C-1.25 11.91, 0.14 10.59, 3.5 9 M3.5 15 C2.13 11.93, 1.8 10.65, 3.5 9 M3.5 9 C5.09 6.91, 8.76 6.05, 10.5 3 M3.5 9 C4.88 7.91, 6.87 5.69, 10.5 3 M10.5 3 C12.61 1.06, 14.36 1.11, 17.5 3 M10.5 3 C11.88 1.19, 13.98 -0.47, 17.5 3" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g stroke-linecap="round" transform="translate(1017.3177800389843 483.30859375) rotate(0 202.779296875 123.326171875)"><path d="M32 0 C156.37 -1.93, 282.77 -1.64, 373.56 0 M32 0 C137.08 -1.04, 242.29 -1.81, 373.56 0 M373.56 0 C396.08 1.15, 406.31 12.31, 405.56 32 M373.56 0 C396.92 0.75, 404.74 12.93, 405.56 32 M405.56 32 C406.07 92.53, 405.66 154.33, 405.56 214.65 M405.56 32 C403.8 84.42, 404.29 138.77, 405.56 214.65 M405.56 214.65 C404.55 234.31, 394.7 245.35, 373.56 246.65 M405.56 214.65 C404.98 237.93, 396.52 248.53, 373.56 246.65 M373.56 246.65 C260.44 247.45, 147.57 248.66, 32 246.65 M373.56 246.65 C285.01 244.83, 196.93 244.6, 32 246.65 M32 246.65 C10.46 248.23, 1.36 235.92, 0 214.65 M32 246.65 C10.48 248.21, -0.05 235.51, 0 214.65 M0 214.65 C-1.37 146.14, -1.06 76.55, 0 32 M0 214.65 C0.67 150.05, -0.8 83, 0 32 M0 32 C0.21 12.1, 9.07 -0.2, 32 0 M0 32 C0.57 10.27, 12.67 -1.11, 32 0" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(1015.9076237889843 540.0625) rotate(0 203.61943161513193 -0.27544646716677335)"><path d="M0.32 -0.35 C68.33 -0.48, 340.19 -0.72, 408.21 -0.61 M-0.97 -1.58 C66.93 -1.5, 339.44 1, 407.63 1.03" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g></g><mask></mask><g transform="translate(1068.0169987889844 497.1015625) rotate(0 59.24993133544922 12.5)"><text x="0" y="17.52" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">TopicOffset</text></g><g transform="translate(1032.9427800389844 551.1484375) rotate(0 103.24988555908203 50)"><text x="0" y="17.52" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">- offset: int</text><text x="0" y="42.519999999999996" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">- topic: Topic</text><text x="0" y="67.52" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic"></text><text x="0" y="92.52" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">+ setOffset(offset);</text></g><g stroke-linecap="round" transform="translate(2537.9857487889844 524.2421875) rotate(0 197.68359375 65.1171875)"><path d="M32 0 C118.69 1.15, 208.2 0.01, 363.37 0 M32 0 C148.26 1.79, 265.31 0.98, 363.37 0 M363.37 0 C385.53 0.05, 396.97 8.7, 395.37 32 M363.37 0 C386.01 -1.89, 393.96 10.65, 395.37 32 M395.37 32 C396.3 46.86, 395.12 60.78, 395.37 98.23 M395.37 32 C395.89 47.59, 394.64 62.22, 395.37 98.23 M395.37 98.23 C394.17 120.37, 386.3 131.77, 363.37 130.23 M395.37 98.23 C393.27 118.34, 386.44 129.23, 363.37 130.23 M363.37 130.23 C257.2 131.68, 150.76 131.74, 32 130.23 M363.37 130.23 C292.86 127.95, 221.04 128.28, 32 130.23 M32 130.23 C8.81 131.14, -0.51 120.95, 0 98.23 M32 130.23 C12.23 130.33, -0.59 118.63, 0 98.23 M0 98.23 C-0.56 77.04, 0.79 54.62, 0 32 M0 98.23 C0.38 82.44, 0.25 67.53, 0 32 M0 32 C-1.35 11.67, 12.48 1.8, 32 0 M0 32 C0.38 9.77, 12.76 0.41, 32 0" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(2525.9115300389844 590.25390625) rotate(0 204.38962701461287 -2.6796245934395415)"><path d="M0.25 -0.5 C68.16 -0.97, 339.64 -2.44, 407.72 -2.89 M-1.08 -1.8 C67.17 -2.65, 341.69 -4.84, 409.86 -4.86" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g></g><mask></mask><g transform="translate(2578.2279362889844 539.20703125) rotate(0 66.09994506835938 25)"><text x="0" y="17.52" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">&lt;&lt;interface&gt;&gt;</text><text x="0" y="42.519999999999996" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Consumer</text></g><g transform="translate(2552.2279362889844 615.20703125) rotate(0 105.21991729736328 12.5)"><text x="0" y="17.52" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">    + consume(Topic);</text></g><g transform="translate(2395.27176515746 75.47530350945294) rotate(0 136.54559617652603 17.98357808018835)"><text x="0" y="12.60289151859601" font-family="Virgil, Segoe UI Emoji" font-size="14.386862464150695px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic"></text><text x="0" y="30.58646959878438" font-family="Virgil, Segoe UI Emoji" font-size="14.386862464150695px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">+ publish(Message m, Topic topic): void</text></g><g stroke-linecap="round" transform="translate(2387.8781580216905 10) rotate(0 153.85337150476198 65.77832202817336)"><path d="M32 0 C123.1 1.16, 212.42 -1.1, 275.71 0 M32 0 C120.94 -0.22, 210.05 0.99, 275.71 0 M275.71 0 C296.51 0.04, 309.39 9.36, 307.71 32 M275.71 0 C298.11 0.9, 308.17 12.65, 307.71 32 M307.71 32 C307.83 53.42, 309.58 74.23, 307.71 99.56 M307.71 32 C308.69 49.37, 307.63 65.31, 307.71 99.56 M307.71 99.56 C306.65 120.04, 295.46 133.07, 275.71 131.56 M307.71 99.56 C308.93 120.85, 296.86 130.36, 275.71 131.56 M275.71 131.56 C203.67 130.56, 133.08 130.89, 32 131.56 M275.71 131.56 C225.75 132.53, 176.62 133.17, 32 131.56 M32 131.56 C10.35 132.58, -1.84 121.6, 0 99.56 M32 131.56 C9.56 132.67, -2.11 121.11, 0 99.56 M0 99.56 C0.79 84.52, -0.61 65.47, 0 32 M0 99.56 C0.52 83.26, 1.2 68.2, 0 32 M0 32 C-1.6 10, 10.14 0.39, 32 0 M0 32 C-0.4 10.66, 9.27 -0.78, 32 0" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(2390.75143454217 67.93158084647334) rotate(0 152.58223068708162 0.5063084900318557)"><path d="M-0.96 0.82 C50.18 0.82, 254.94 0.02, 306.12 -0.01 M0.74 0.21 C51.74 0.33, 254.2 0.76, 304.95 1.02" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g></g><mask></mask><g transform="translate(2433.539873005533 38.02107254951966) rotate(0 40.044151306152344 11.828179257322262)"><text x="0" y="16.57837604706288" font-family="Virgil, Segoe UI Emoji" font-size="18.925086811715612px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Publisher</text></g><g transform="translate(2443.002416411391 20.382300232037863) rotate(0 62.530548095703125 11.828179257322248)"><text x="0" y="16.57837604706287" font-family="Virgil, Segoe UI Emoji" font-size="18.92508681171561px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">&lt;&lt;interface&gt;&gt;</text></g><g stroke-linecap="round"><g transform="translate(2521.0758217661655 222.88671875) rotate(0 -11.214277987371588 -40.57603123505578)"><path d="M0.49 0.28 C-3.52 -13.36, -19.03 -68.15, -22.92 -81.43" stroke="#1e1e1e" stroke-width="1.5" fill="none" stroke-dasharray="1.5 7"></path></g><g transform="translate(2521.0758217661655 222.88671875) rotate(0 -11.214277987371588 -40.57603123505578)"><path d="M-22.06 -81.35 L-13.22 -68.91 L-23.65 -68.06 L-24.23 -81.07" stroke="none" stroke-width="0" fill="#1e1e1e" fill-rule="evenodd"></path><path d="M-22.92 -81.43 C-18.67 -77.94, -16.53 -73.41, -13.07 -70.11 M-13.07 -70.11 C-16.89 -68.55, -22.06 -66.54, -25.25 -66.61 M-25.25 -66.61 C-25.83 -70.14, -23.82 -73.78, -22.92 -81.43 M-22.92 -81.43 C-22.92 -81.43, -22.92 -81.43, -22.92 -81.43" stroke="#1e1e1e" stroke-width="1.5" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(2450.0755925389844 233.2734375) rotate(0 182.189453125 100.251953125)"><path d="M32 0 C94.47 2.38, 157.35 2.49, 332.38 0 M32 0 C138.31 0.58, 243.35 0.32, 332.38 0 M332.38 0 C353.66 -1.35, 363.3 11.17, 364.38 32 M332.38 0 C351.97 2.22, 365.97 11.09, 364.38 32 M364.38 32 C365.64 78.87, 364.54 128.42, 364.38 168.5 M364.38 32 C365.64 82.74, 365.89 133.42, 364.38 168.5 M364.38 168.5 C362.78 189.53, 352.96 201.8, 332.38 200.5 M364.38 168.5 C365.73 189.8, 355.24 199.97, 332.38 200.5 M332.38 200.5 C258.95 200.68, 185.51 201.84, 32 200.5 M332.38 200.5 C238.42 201.02, 144.51 201.56, 32 200.5 M32 200.5 C12.15 201.13, -1.78 190.21, 0 168.5 M32 200.5 C11.23 202.38, 1.12 189.3, 0 168.5 M0 168.5 C-0.07 116.1, -0.02 63.62, 0 32 M0 168.5 C0.53 121.49, -0.09 76.47, 0 32 M0 32 C-0.86 10.2, 9.94 0.63, 32 0 M0 32 C2.01 11, 10.53 2.08, 32 0" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g transform="translate(2477.5169987889844 241.04296875) rotate(0 47.779945373535156 12.5)"><text x="0" y="17.52" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">IPublisher</text></g><g stroke-linecap="round"><g transform="translate(2448.7005925389844 283.58984375) rotate(0 182.55913566465938 0.6253286194475436)"><path d="M0.61 -0.54 C61.55 -0.34, 304.82 1.19, 365.65 1.18 M-0.53 1.79 C60.28 1.66, 303.94 -0.24, 364.86 -0.51" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g></g><mask></mask><g transform="translate(2473.4779362889844 299.43359375) rotate(0 160.88986206054688 50)"><text x="0" y="17.52" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">- queue: Queue</text><text x="0" y="42.519999999999996" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">+ publish(Message, Topic): void {</text><text x="0" y="67.52" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">    //add message to topic</text><text x="0" y="92.52" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">}</text></g><g stroke-linecap="round"><g transform="translate(2737.2863866448097 759.8125) rotate(0 0.1976839006922546 -54.017582323402166)"><path d="M0.73 1.03 C0.82 -17.31, -0.32 -90.59, -0.34 -109.06" stroke="#1e1e1e" stroke-width="1.5" fill="none" stroke-dasharray="1.5 7"></path></g><g transform="translate(2737.2863866448097 759.8125) rotate(0 0.1976839006922546 -54.017582323402166)"><path d="M-0.23 -110.33 L4.49 -96.68 L-7.66 -94.43 L0.36 -107.7" stroke="none" stroke-width="0" fill="#1e1e1e" fill-rule="evenodd"></path><path d="M-0.34 -109.06 C2.53 -106.43, 3.02 -102.12, 6.12 -95.52 M6.12 -95.52 C2.47 -96.67, 0.29 -96.15, -6.56 -95.41 M-6.56 -95.41 C-4.33 -99.62, -1.66 -103.4, -0.34 -109.06 M-0.34 -109.06 C-0.34 -109.06, -0.34 -109.06, -0.34 -109.06" stroke="#1e1e1e" stroke-width="1.5" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(2576.4623112889844 765.5) rotate(0 168.541015625 77.7109375)"><path d="M32 0 C129.61 -1.96, 227.38 -0.7, 305.08 0 M32 0 C123.16 1.97, 213.33 1.47, 305.08 0 M305.08 0 C327.89 1.17, 336.35 11.92, 337.08 32 M305.08 0 C328.31 2.29, 339.14 9.24, 337.08 32 M337.08 32 C336.06 59.22, 335.52 88.61, 337.08 123.42 M337.08 32 C337.06 66.01, 337.93 98.64, 337.08 123.42 M337.08 123.42 C338.91 146.19, 325.81 155.64, 305.08 155.42 M337.08 123.42 C336.83 142.87, 324.64 154.41, 305.08 155.42 M305.08 155.42 C211.16 154.05, 117.19 154.68, 32 155.42 M305.08 155.42 C227.6 153.19, 151.11 153.54, 32 155.42 M32 155.42 C9.76 155.62, 0.23 143.2, 0 123.42 M32 155.42 C10.68 154.51, 1.26 143.35, 0 123.42 M0 123.42 C-0.5 100.98, -0.92 78.72, 0 32 M0 123.42 C-0.61 102.13, 0.01 78.47, 0 32 M0 32 C-0.69 11.66, 12.19 -1.55, 32 0 M0 32 C1.66 8.86, 12.67 -0.74, 32 0" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g transform="translate(2628.2279362889844 775.20703125) rotate(0 49.30995178222656 12.5)"><text x="0" y="17.52" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">IConsumer</text></g><g stroke-linecap="round"><g transform="translate(2576.0521550389844 808.5390625) rotate(0 170.1927939154209 1.1685478957462578)"><path d="M-0.32 -0.27 C56.34 0.38, 283.9 2.26, 340.71 2.8 M1.71 -1.45 C58.1 -0.59, 282.57 2.9, 339.47 3.79" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g></g><mask></mask><g transform="translate(2595.5873112889844 838.20703125) rotate(0 172.03985595703125 50)"><text x="0" y="17.52" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">+ consume(Topic) {</text><text x="0" y="42.519999999999996" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">// get one message from the topic</text><text x="0" y="67.52" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">    Thread.sleep(5000);</text><text x="0" y="92.52" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">}</text></g><g transform="translate(2599.2279362889844 819.84765625) rotate(0 73.63993072509766 12.5)"><text x="0" y="17.52" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">- queue: Queue</text></g><g stroke-linecap="round"><g transform="translate(1000.1071891582084 998.0490723534162) rotate(0 266.1361979582791 -1.3703320831855308)"><path d="M-1.02 0.33 C87.73 -0.03, 444.38 -1.05, 533.29 -1.29 M0.65 -0.55 C89.2 -1.33, 444.08 -2.66, 532.55 -3.07" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(1007.8994485558909 942.28515625) rotate(0 262.7536433968585 168.126953125)"><path d="M32 0 C198.97 -2.11, 364.23 -0.71, 493.51 0 M32 0 C137.32 0.69, 243.08 0.3, 493.51 0 M493.51 0 C514.68 0.92, 525.03 8.74, 525.51 32 M493.51 0 C515.31 -0.93, 526.62 8.42, 525.51 32 M525.51 32 C527.06 102.87, 526.11 173.34, 525.51 304.25 M525.51 32 C527.22 88.89, 526.53 144.68, 525.51 304.25 M525.51 304.25 C524.19 324.5, 514.91 336.65, 493.51 336.25 M525.51 304.25 C525.77 326.68, 516.73 337.54, 493.51 336.25 M493.51 336.25 C314.75 334.82, 136.38 335.72, 32 336.25 M493.51 336.25 C330.56 338.05, 166.81 337.96, 32 336.25 M32 336.25 C10.19 338.06, 1.82 325.97, 0 304.25 M32 336.25 C8.71 336.51, 0.69 327.35, 0 304.25 M0 304.25 C1.4 239.45, 1.2 176.1, 0 32 M0 304.25 C0.36 197.59, 1.35 89.21, 0 32 M0 32 C0.55 11.32, 11.76 -0.72, 32 0 M0 32 C1.65 8.45, 10.09 2.07, 32 0" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g transform="translate(1063.4394491593735 966.8576432126922) rotate(0 82.773417148411 14.330591995738132)"><text x="0" y="20.085757741226608" font-family="Virgil, Segoe UI Emoji" font-size="22.92894719318106px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">ConsumerGroup</text></g><g transform="translate(1039.3237498165454 1026.3788614049909) rotate(0 152.06461964485493 28.661183991476378)"><text x="0" y="20.085757741226608" font-family="Virgil, Segoe UI Emoji" font-size="22.92894719318106px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">- id: int</text><text x="0" y="48.746941732702936" font-family="Virgil, Segoe UI Emoji" font-size="22.92894719318106px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">- topicOffset: TopicOffset</text></g><g transform="translate(1039.3640546065335 1110.6350452446213) rotate(0 144.41781785513683 28.661183991476378)"><text x="0" y="20.085757741226608" font-family="Virgil, Segoe UI Emoji" font-size="22.92894719318106px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">+ incrementOffset();</text><text x="0" y="48.746941732702936" font-family="Virgil, Segoe UI Emoji" font-size="22.92894719318106px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">+resetOffset(newOffset);</text></g><g stroke-linecap="round" transform="translate(1515.548842104532 134.328125) rotate(0 392.46783399747744 340.228515625)"><path d="M32 0 C293.43 -0.24, 555.03 -1.06, 752.94 0 M32 0 C315.05 -0.88, 598.34 -0.93, 752.94 0 M752.94 0 C772.71 0.27, 784.91 9.66, 784.94 32 M752.94 0 C773.49 0.62, 786.42 12.74, 784.94 32 M784.94 32 C783.82 194.62, 783.87 357, 784.94 648.46 M784.94 32 C786.67 205.93, 786.27 379.67, 784.94 648.46 M784.94 648.46 C784.99 668.36, 774.22 681.92, 752.94 680.46 M784.94 648.46 C784.94 672.06, 774.34 681.39, 752.94 680.46 M752.94 680.46 C540.87 681.71, 327.91 682.1, 32 680.46 M752.94 680.46 C582.15 678.92, 411.96 679.25, 32 680.46 M32 680.46 C11.59 681.8, -0.01 670.84, 0 648.46 M32 680.46 C11.14 679.64, -2.11 671.45, 0 648.46 M0 648.46 C2.66 447.42, 2.98 244.5, 0 32 M0 648.46 C-1.1 414.52, -1.05 180.4, 0 32 M0 32 C-0.23 10.26, 10.6 -0.01, 32 0 M0 32 C2.13 10.14, 9.26 1.36, 32 0" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(1519.9117766597947 247.00922825244902) rotate(0 386.28689702822294 -0.8747740721416051)"><path d="M-0.74 0.58 C128.07 0.1, 644.21 -1.78, 773.32 -2.33 M1.07 -0.16 C129.65 -0.52, 643.49 -0.77, 772.18 -1.06" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g></g><mask></mask><g transform="translate(1550.1607085249425 167.42960105166503) rotate(0 377.98558773205957 27.68408742841146)"><text x="0" y="12.934005646553828" font-family="Virgil, Segoe UI Emoji" font-size="14.764846628486106px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Queue - Main class that has all the topic handlers and methods to add topic, add subcriber to topic </text><text x="0" y="31.39006393216146" font-family="Virgil, Segoe UI Emoji" font-size="14.764846628486106px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">with a consumer group, as well for pushing and consuming messages </text><text x="0" y="49.84612221776909" font-family="Virgil, Segoe UI Emoji" font-size="14.764846628486106px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic"></text></g><g transform="translate(1532.6117669633304 297.0951187724577) rotate(0 270.5372837850657 83.74441648489909)"><text x="0" y="16.768024877890653" font-family="Virgil, Segoe UI Emoji" font-size="19.14158091083408px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">- topicHandlers: Map&lt;int, TopicHandler&gt;</text><text x="0" y="40.69500101643325" font-family="Virgil, Segoe UI Emoji" font-size="19.14158091083408px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic"></text><text x="0" y="64.62197715497585" font-family="Virgil, Segoe UI Emoji" font-size="19.14158091083408px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">+ addMessageToTopic(Topic topic, String message): void </text><text x="0" y="88.54895329351845" font-family="Virgil, Segoe UI Emoji" font-size="19.14158091083408px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">+ addTopicInQueue(Topic): void</text><text x="0" y="112.47592943206105" font-family="Virgil, Segoe UI Emoji" font-size="19.14158091083408px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">+ removeTopic(int id): void</text><text x="0" y="136.40290557060365" font-family="Virgil, Segoe UI Emoji" font-size="19.14158091083408px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">+ addSubscriberToTopic(Consumer consumer, Topic topic,</text><text x="0" y="160.32988170914626" font-family="Virgil, Segoe UI Emoji" font-size="19.14158091083408px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">     ConsumerGroup consumerGroup)</text></g><g stroke-linecap="round" transform="translate(1475.7982487889844 271.4971923828125) rotate(0 18.796875 14.041015625)"><path d="M23.75 3.75 C25.62 5.33, 27.64 7.66, 32.84 11.25 M23.75 3.75 C26.67 5.71, 28.72 8.47, 32.84 11.25 M32.84 11.25 C38.04 14.77, 39.58 14.99, 32.84 18.75 M32.84 11.25 C38.8 15.32, 36.53 15.97, 32.84 18.75 M32.84 18.75 C29.35 20.45, 26.2 22.85, 23.75 24.33 M32.84 18.75 C30.64 20.06, 27.74 21.86, 23.75 24.33 M23.75 24.33 C20.97 30.02, 17.61 27.24, 14.25 24.33 M23.75 24.33 C19.1 26.26, 18.31 26.47, 14.25 24.33 M14.25 24.33 C12.46 22.71, 9.33 22.16, 4.75 18.75 M14.25 24.33 C10.41 22.88, 8.04 20.61, 4.75 18.75 M4.75 18.75 C-1.04 13.42, -0.81 15.82, 4.75 11.25 M4.75 18.75 C-1.23 17.26, -0.48 15.57, 4.75 11.25 M4.75 11.25 C7.86 8.24, 9.62 6.41, 14.25 3.75 M4.75 11.25 C7.19 9.59, 8.82 8.36, 14.25 3.75 M14.25 3.75 C20.37 -1.76, 17.64 1.74, 23.75 3.75 M14.25 3.75 C17.92 -0.25, 20.53 -0.11, 23.75 3.75" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(1188.242541962447 939.6553615606235) rotate(0 15.557007774304793 -102.86891618179322)"><path d="M0.3 1.09 C5.29 -33.52, 24.55 -172.4, 29.76 -206.83 M-1 0.62 C4.39 -33.88, 26.71 -170.75, 32.11 -205.38" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g transform="translate(1188.242541962447 939.6553615606235) rotate(0 15.557007774304793 -102.86891618179322)"><path d="M36.85 -180.83 C37.13 -189.02, 33.67 -193.05, 32.11 -205.38 M36.85 -180.83 C34.71 -191.2, 33.7 -199.89, 32.11 -205.38" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g transform="translate(1188.242541962447 939.6553615606235) rotate(0 15.557007774304793 -102.86891618179322)"><path d="M19.96 -183.53 C25.12 -190.98, 26.51 -194.24, 32.11 -205.38 M19.96 -183.53 C24.58 -192.87, 30.32 -200.49, 32.11 -205.38" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(1848.9452770156668 1034.5811083858166) rotate(0 -156.7021589907415 -5.977109882846776)"><path d="M-0.4 -0.94 C-52.65 -2.96, -261.83 -9.34, -314.21 -11.4 M1.59 1.18 C-50.72 -1.25, -262.13 -10.85, -314.99 -13.13" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(1868.2435612889844 948.28125) rotate(0 176.99609375 81.77734375)"><path d="M32 0 C146.5 1.72, 262.75 -0.83, 321.99 0 M32 0 C126.62 1.64, 220.83 1.77, 321.99 0 M321.99 0 C343.99 1.41, 354.8 9.98, 353.99 32 M321.99 0 C343.21 2.19, 355.74 8.7, 353.99 32 M353.99 32 C354.02 57.27, 354.83 85.59, 353.99 131.55 M353.99 32 C353.01 55.58, 353.42 78.81, 353.99 131.55 M353.99 131.55 C355.6 153.19, 344.86 162.83, 321.99 163.55 M353.99 131.55 C355.84 151.41, 344.01 164.44, 321.99 163.55 M321.99 163.55 C208.46 164.62, 94.66 165.39, 32 163.55 M321.99 163.55 C256.72 163.38, 192.86 162.91, 32 163.55 M32 163.55 C10.09 164.82, -0.24 152.82, 0 131.55 M32 163.55 C11.43 163.2, 1.1 153.84, 0 131.55 M0 131.55 C0.65 106.49, -0.56 84.28, 0 32 M0 131.55 C0.56 102.57, 0.71 74.98, 0 32 M0 32 C-1.39 11.64, 10.22 1.06, 32 0 M0 32 C-1.91 10.76, 9.18 1.85, 32 0" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g transform="translate(1904.0287175389844 949.109375) rotate(0 43.859954833984375 12.5)"><text x="0" y="17.52" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Consumer</text></g><g stroke-linecap="round"><g transform="translate(1870.5755925389844 981.2109375) rotate(0 174.6710585327212 -2.3473170070861897)"><path d="M-0.08 -1.17 C58.56 -2.06, 292.34 -4.86, 350.92 -5.52 M-1.57 0.82 C57.02 0.17, 291.4 -2.58, 350.17 -3.91" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g></g><mask></mask><g transform="translate(1883.1107487889844 999.46484375) rotate(0 259.21978759765625 62.5)"><text x="0" y="17.52" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">- id: consumerId;</text><text x="0" y="42.519999999999996" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">- topicIdToConsumerGroup: Map&lt;int, ConsumerGroup&gt;</text><text x="0" y="67.52" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">- pollMessage(Topic): Message</text><text x="0" y="92.52" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic"></text><text x="0" y="117.52" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">+ addConsumerToTopic(</text></g><g stroke-linecap="round" transform="translate(1845.3099675389844 1015.3643798828125) rotate(0 9.712890625 12.73046875)"><path d="M12.5 3.25 C14.08 4.19, 15.39 5.86, 16.93 9.75 M12.5 3.25 C14.28 5.57, 16.27 8.08, 16.93 9.75 M16.93 9.75 C18.92 13.27, 19.09 12.66, 16.93 16.25 M16.93 9.75 C19.57 14.88, 19.61 11.56, 16.93 16.25 M16.93 16.25 C15.3 17.51, 14.42 20.23, 12.5 22.21 M16.93 16.25 C15.54 18.37, 13.76 20.19, 12.5 22.21 M12.5 22.21 C10.26 27, 8.88 27.3, 7.5 22.21 M12.5 22.21 C11.6 27.56, 12.12 27.09, 7.5 22.21 M7.5 22.21 C4.94 19.54, 4.24 17.6, 2.5 16.25 M7.5 22.21 C5.64 20.37, 4.54 18.45, 2.5 16.25 M2.5 16.25 C0.63 11.57, -0.05 12.34, 2.5 9.75 M2.5 16.25 C2.14 12.81, 0.07 13.6, 2.5 9.75 M2.5 9.75 C3.88 8.72, 4.53 6.19, 7.5 3.25 M2.5 9.75 C4.53 7.19, 6.42 4.37, 7.5 3.25 M7.5 3.25 C10.16 -0.84, 10.64 -1.56, 12.5 3.25 M7.5 3.25 C8.98 0.96, 12.12 0.53, 12.5 3.25" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g stroke-linecap="round" transform="translate(10 545.359375) rotate(0 449.54567205918505 367.55859375)"><path d="M32 0 C241.84 2.36, 450.87 2.11, 867.09 0 M32 0 C210.37 1.68, 387.82 1.67, 867.09 0 M867.09 0 C888.49 -0.79, 898.49 8.94, 899.09 32 M867.09 0 C886.76 -0.15, 898.73 9.52, 899.09 32 M899.09 32 C900.7 270.22, 901.01 507.48, 899.09 703.12 M899.09 32 C900.22 266.05, 899.92 499.55, 899.09 703.12 M899.09 703.12 C899.01 726.08, 888.49 736, 867.09 735.12 M899.09 703.12 C897.1 724.74, 887.51 733.26, 867.09 735.12 M867.09 735.12 C685.68 737.34, 503.6 737.4, 32 735.12 M867.09 735.12 C632.94 737.24, 398.45 737.14, 32 735.12 M32 735.12 C11.67 735.34, -0.56 722.83, 0 703.12 M32 735.12 C8.94 735.07, -1.97 724.87, 0 703.12 M0 703.12 C-0.52 490.94, -0.55 279.74, 0 32 M0 703.12 C2.87 472.84, 2.95 242.63, 0 32 M0 32 C-1.05 11.51, 11.76 1.37, 32 0 M0 32 C0.45 9.17, 12.12 -2.14, 32 0" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(15.55088306392878 699.5614786360518) rotate(0 452.9495031726318 0.8917321702651861)"><path d="M-0.5 -0.24 C150.63 0.18, 755.54 1.71, 906.4 2.23 M1.44 -1.42 C152.5 -0.86, 754.85 2.3, 905.77 3.2" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g></g><mask></mask><g transform="translate(118.78659895384419 600.7254176505044) rotate(0 138.58417931805695 28.557597756546443)"><text x="0" y="40.026329015575485" font-family="Virgil, Segoe UI Emoji" font-size="45.6921564104743px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">TopicHandler</text></g><g transform="translate(20.233619891220997 703.7851987340933) rotate(0 305.2415466308594 280.4145728472377)"><text x="0" y="15.721162612107538" font-family="Virgil, Segoe UI Emoji" font-size="17.946532662223216px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">- topic: Topic</text><text x="0" y="38.154328439886555" font-family="Virgil, Segoe UI Emoji" font-size="17.946532662223216px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">- consumerIdToConsumerMap: Map&lt;int, Consumer&gt; ;</text><text x="0" y="60.587494267665576" font-family="Virgil, Segoe UI Emoji" font-size="17.946532662223216px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">- consumerGroupToConsumableSemaphore:</text><text x="0" y="83.0206600954446" font-family="Virgil, Segoe UI Emoji" font-size="17.946532662223216px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">      Map&lt;int, Semaphore(0)&gt; </text><text x="0" y="105.45382592322362" font-family="Virgil, Segoe UI Emoji" font-size="17.946532662223216px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">- groupIdToBinarySemaphoreMap: Map&lt;int, Semaphore(1)&gt;;</text><text x="0" y="127.88699175100264" font-family="Virgil, Segoe UI Emoji" font-size="17.946532662223216px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic"></text><text x="0" y="150.32015757878168" font-family="Virgil, Segoe UI Emoji" font-size="17.946532662223216px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">// Not used currently can beused for limiting publisher message push</text><text x="0" y="172.7533234065607" font-family="Virgil, Segoe UI Emoji" font-size="17.946532662223216px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">- globalCapacitySemaphore: Semaphore(topic.getCapacity()); </text><text x="0" y="195.18648923433972" font-family="Virgil, Segoe UI Emoji" font-size="17.946532662223216px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic"></text><text x="0" y="217.61965506211874" font-family="Virgil, Segoe UI Emoji" font-size="17.946532662223216px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">+ synchronized addMessage(Message): void {</text><text x="0" y="240.05282088989776" font-family="Virgil, Segoe UI Emoji" font-size="17.946532662223216px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">    topic.addMessage(message);</text><text x="0" y="262.4859867176768" font-family="Virgil, Segoe UI Emoji" font-size="17.946532662223216px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">    for(int i=0;i&lt;subscriberIdToConsumableSemaphore.size();i++) {</text><text x="0" y="284.9191525454558" font-family="Virgil, Segoe UI Emoji" font-size="17.946532662223216px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">        consumerGroupToConsumableSemaphore[i].release();    </text><text x="0" y="307.3523183732348" font-family="Virgil, Segoe UI Emoji" font-size="17.946532662223216px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">    }</text><text x="0" y="329.78548420101384" font-family="Virgil, Segoe UI Emoji" font-size="17.946532662223216px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">}</text><text x="0" y="352.21865002879287" font-family="Virgil, Segoe UI Emoji" font-size="17.946532662223216px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic"></text><text x="0" y="374.6518158565719" font-family="Virgil, Segoe UI Emoji" font-size="17.946532662223216px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">+ Message pollMessageForConsumer(consumerId) {</text><text x="0" y="397.0849816843509" font-family="Virgil, Segoe UI Emoji" font-size="17.946532662223216px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">    Consumer consumer = consumerIdToConsumerMap.get(consumerId);</text><text x="0" y="419.51814751212993" font-family="Virgil, Segoe UI Emoji" font-size="17.946532662223216px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">    ConsumerGroup group = consumer.getConsumerGroup();</text><text x="0" y="441.95131333990895" font-family="Virgil, Segoe UI Emoji" font-size="17.946532662223216px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">    groupIdToBinarySemaphoreMap.get(group.getId()).acquire();</text><text x="0" y="464.38447916768797" font-family="Virgil, Segoe UI Emoji" font-size="17.946532662223216px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">    group.incrementOffset();</text><text x="0" y="486.817644995467" font-family="Virgil, Segoe UI Emoji" font-size="17.946532662223216px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">    groupIdToBinarySemaphoreMap.get(group.getId()).release();</text><text x="0" y="509.250810823246" font-family="Virgil, Segoe UI Emoji" font-size="17.946532662223216px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">    consumerGroupToConsumableSemaphore[i].acquire();</text><text x="0" y="531.683976651025" font-family="Virgil, Segoe UI Emoji" font-size="17.946532662223216px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">    return message;</text><text x="0" y="554.117142478804" font-family="Virgil, Segoe UI Emoji" font-size="17.946532662223216px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">}</text></g><g transform="translate(411.4310612889843 623.0479736328125) rotate(0 253.31979370117188 12.5)"><text x="0" y="17.52" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">: Handles pushing message and polling it for a topic</text></g><g stroke-linecap="round"><g transform="translate(422.12578355658866 544.359375) rotate(0 527.082159127143 -127.64352075137577)"><path d="M-0.63 -1.19 C175.34 -44, 879.04 -213.76, 1054.8 -256.08 M1.24 0.8 C177.13 -41.89, 877.97 -211.69, 1053.8 -254.68" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(683.8695640141862 240.46535022888645) rotate(0 112.02112396690654 -41.501772119649615)"><path d="M0.68 0.31 C37.7 -13.54, 185.09 -69.65, 222.21 -83.31 M-0.43 -0.57 C36.97 -14.28, 187.25 -68.45, 224.47 -82.3" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g></g><mask></mask></svg>